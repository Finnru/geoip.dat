- name: Prepare Data (IP2Location CIDR)
        run: |
          mkdir -p data
          # Используем другой формат URL, который часто лучше работает в скриптах
          # Также добавляем заголовки, чтобы имитировать браузер
          TOKEN="Tw4ykNbvL6MSjRfIDPbktXhNsv3TSEdaQ5g7kutMxgeX0iUlrYr2JfCL1wrR7q8w"
          
          echo "Attempting to download..."
          curl -L -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64)" \
               "https://www.ip2location.com/download/?token=${TOKEN}&file=DB1LITECIDR" \
               -o db.zip

          # Проверка: если файл меньше 10кб, значит это ошибка
          SIZE=$(stat -c%s db.zip)
          if [ "$SIZE" -lt 10000 ]; then
            echo "ERROR: Downloaded file is too small ($SIZE bytes)."
            echo "Contents of the file:"
            cat db.zip
            exit 1
          fi

          unzip -o db.zip
          CSV_FILE=$(ls *.CSV 2>/dev/null | head -n 1) || CSV_FILE=$(ls *.csv 2>/dev/null | head -n 1)
          
          # Парсинг RU
          awk -F',' '$2 ~ /"RU"/ {gsub(/"/, "", $1); print $1}' "$CSV_FILE" > data/ru
          echo "Found $(wc -l < data/ru) RU ranges."
